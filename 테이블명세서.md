# í…Œì´ë¸” ëª…ì„¸ì„œ

---

## ğŸ“‹ ëª©ì°¨

1. [í…Œì´ë¸” ëª©ë¡](#i-í…Œì´ë¸”-ëª©ë¡)
2. [í…Œì´ë¸” ì •ì˜ì„œ](#ii-í…Œì´ë¸”-ì •ì˜ì„œ)
   - [1. ì˜ì‚¬ í…Œì´ë¸”](#1-ì˜ì‚¬-í…Œì´ë¸”-tb_user)
   - [2. í™˜ì í…Œì´ë¸”](#2-í™˜ì-í…Œì´ë¸”-tb_patient)
   - [3. íŒë…ê²°ê³¼ í…Œì´ë¸”](#3-íŒë…ê²°ê³¼-í…Œì´ë¸”-tb_diagnosis)
   - [4. ì§„ë‹¨ ë°œê²¬ ì‚¬í•­ í…Œì´ë¸”](#4-ì§„ë‹¨-ë°œê²¬-ì‚¬í•­-í…Œì´ë¸”-tb_diagnosis_finding)
   - [5. ì¼ì • í…Œì´ë¸”](#5-ì¼ì •-í…Œì´ë¸”-tb_schedule)
3. [ê´€ê³„ ìš”ì•½](#iii-ê´€ê³„-ìš”ì•½)
4. [ì¸ë±ìŠ¤ ìš”ì•½](#iv-ì¸ë±ìŠ¤-ìš”ì•½)
5. [ë°ì´í„° íƒ€ì… ì„¤ëª…](#v-ë°ì´í„°-íƒ€ì…-ì„¤ëª…)
6. [ì œì•½ì¡°ê±´](#vi-ì œì•½ì¡°ê±´)
7. [ì°¸ê³ ì‚¬í•­](#vii-ì°¸ê³ ì‚¬í•­)

---

## I. í…Œì´ë¸” ëª©ë¡

| í…Œì´ë¸”ëª… | í…Œì´ë¸”_ID | ë¹„ê³  |
|:---------|:----------|:-----|
| ì˜ì‚¬ í…Œì´ë¸” | `tb_user` | ì˜ì‚¬ ë° ê´€ë¦¬ì ì •ë³´ ê´€ë¦¬ |
| í™˜ì í…Œì´ë¸” | `tb_patient` | í™˜ì ì •ë³´ ê´€ë¦¬ |
| íŒë…ê²°ê³¼ í…Œì´ë¸” | `tb_diagnosis` | AI ì§„ë‹¨ ê²°ê³¼ ë° íŒë… ì •ë³´ ê´€ë¦¬ |
| ì§„ë‹¨ ë°œê²¬ ì‚¬í•­ í…Œì´ë¸” | `tb_diagnosis_finding` | AI ì§„ë‹¨ì—ì„œ ë°œê²¬ëœ ê° ì§ˆí™˜ë³„ ì •ë³´ |
| ì¼ì • í…Œì´ë¸” | `tb_schedule` | ì˜ì‚¬ ì¼ì • ê´€ë¦¬ |

---

## II. í…Œì´ë¸” ì •ì˜ì„œ

---

### 1. ì˜ì‚¬ í…Œì´ë¸” (tb_user)

#### ğŸ“Œ ê¸°ë³¸ ì •ë³´

- **ì‘ì„±ì¼ì**: 2025-01-XX
- **ì‘ì„±ì**: [ì‘ì„±ìëª…]
- **í…Œì´ë¸”ëª…**: ì˜ì‚¬ í…Œì´ë¸”
- **í…Œì´ë¸” ID**: `tb_user`
- **í…Œì´ë¸”ì„¤ëª…**: ì˜ì‚¬ ë° ê´€ë¦¬ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

#### ğŸ“Š ì»¬ëŸ¼ ì •ì˜

| ì»¬ëŸ¼ëª… | ì»¬ëŸ¼ ID | íƒ€ì… | ê¸¸ì´ | NN | PK | FK | UK | CK | ë¹„ê³  |
|:-------|:--------|:-----|:-----|:---|:---|:---|:---|:---|:-----|
| ì˜ì‚¬ ê³ ìœ  ID | `user_idx` | int | - | âœ… | âœ… | - | - | - | auto_increment |
| ì˜ì‚¬ ì´ë¦„ | `user_name` | varchar | 50 | âœ… | - | - | - | - | - |
| ì˜ì‚¬ ë¡œê·¸ì¸ ID | `user_email` | varchar | 100 | âœ… | - | - | âœ… | - | ì´ë©”ì¼ í˜•ì‹, unique |
| ì˜ì‚¬ ë¹„ë°€ë²ˆí˜¸ | `user_password` | varchar | 255 | âœ… | - | - | - | - | bcrypt ì•”í˜¸í™” ì €ì¥ |
| ì†Œì† ë³‘ì› | `user_hospital` | varchar | 100 | - | - | - | - | - | - |
| ì†Œì† ë¶€ì„œ | `user_department` | varchar | 50 | - | - | - | - | - | - |
| ë©´í—ˆë²ˆí˜¸ | `user_license` | varchar | 50 | - | - | - | - | - | - |
| ì˜ì‚¬ ì—­í•  | `user_role` | varchar | 20 | âœ… | - | - | - | - | 'doctor' / 'admin', ê¸°ë³¸ê°’: 'doctor' |
| í”„ë¡œí•„ ì´ë¯¸ì§€ ê²½ë¡œ | `user_profile_img` | varchar | 255 | - | - | - | - | - | - |
| ìƒì„± ì¼ì‹œ | `created_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP |
| ìˆ˜ì • ì¼ì‹œ | `updated_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

#### ğŸ’» Table ìƒì„± ìŠ¤í¬ë¦½íŠ¸

```sql
CREATE TABLE tb_user (
    user_idx INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    user_name VARCHAR(50) NOT NULL,
    user_email VARCHAR(100) NOT NULL UNIQUE,
    user_password VARCHAR(255) NOT NULL,
    user_hospital VARCHAR(100),
    user_department VARCHAR(50),
    user_license VARCHAR(50),
    user_role VARCHAR(20) NOT NULL DEFAULT 'doctor',
    user_profile_img VARCHAR(255),
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_user_email (user_email),
    INDEX idx_user_role (user_role)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

### 2. í™˜ì í…Œì´ë¸” (tb_patient)

#### ğŸ“Œ ê¸°ë³¸ ì •ë³´

- **ì‘ì„±ì¼ì**: 2025-01-XX
- **ì‘ì„±ì**: [ì‘ì„±ìëª…]
- **í…Œì´ë¸”ëª…**: í™˜ì í…Œì´ë¸”
- **í…Œì´ë¸” ID**: `tb_patient`
- **í…Œì´ë¸”ì„¤ëª…**: í™˜ì ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

#### ğŸ“Š ì»¬ëŸ¼ ì •ì˜

| ì»¬ëŸ¼ëª… | ì»¬ëŸ¼ ID | íƒ€ì… | ê¸¸ì´ | NN | PK | FK | UK | CK | ë¹„ê³  |
|:-------|:--------|:-----|:-----|:---|:---|:---|:---|:---|:-----|
| í™˜ì ê³ ìœ  ID | `patient_idx` | int | - | âœ… | âœ… | - | - | - | auto_increment |
| í™˜ì ì´ë¦„ | `patient_name` | varchar | 50 | âœ… | - | - | - | - | - |
| í™˜ì ë‚˜ì´ | `patient_age` | int | - | - | - | - | - | - | - |
| í™˜ì ì„±ë³„ | `patient_gender` | varchar | 10 | âœ… | - | - | - | - | 'ë‚¨ì„±' / 'ì—¬ì„±' / 'ê¸°íƒ€', ê¸°ë³¸ê°’: 'ë‚¨ì„±' |
| ë³‘ì‹¤ ë²ˆí˜¸ | `patient_room` | varchar | 20 | - | - | - | - | - | - |
| ì˜ë¬´ê¸°ë¡ë²ˆí˜¸ | `patient_record_no` | varchar | 50 | - | - | - | - | - | - |
| í™˜ì ìƒíƒœ | `patient_status` | varchar | 20 | âœ… | - | - | - | - | 'normal' / 'pending' / 'urgent', ê¸°ë³¸ê°’: 'normal' |
| ë‹´ë‹¹ ì˜ì‚¬ ID | `doctor_id` | int | - | - | - | âœ… | - | - | `tb_user.user_idx` ì°¸ì¡° |
| ì¦ìƒ/ë©”ëª¨ | `patient_symptoms` | varchar | 1000 | - | - | - | - | - | - |
| ì‚­ì œ ì—¬ë¶€ | `is_deleted` | boolean | - | âœ… | - | - | - | - | ê¸°ë³¸ê°’: FALSE |
| ì‚­ì œ ì¼ì‹œ | `deleted_at` | timestamp | - | - | - | - | - | - | - |
| ìƒì„± ì¼ì‹œ | `created_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP |
| ìˆ˜ì • ì¼ì‹œ | `updated_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

#### ğŸ’» Table ìƒì„± ìŠ¤í¬ë¦½íŠ¸

```sql
CREATE TABLE tb_patient (
    patient_idx INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    patient_name VARCHAR(50) NOT NULL,
    patient_age INT,
    patient_gender VARCHAR(10) NOT NULL DEFAULT 'ë‚¨ì„±',
    patient_room VARCHAR(20),
    patient_record_no VARCHAR(50),
    patient_status VARCHAR(20) NOT NULL DEFAULT 'normal',
    doctor_id INT,
    patient_symptoms VARCHAR(1000),
    is_deleted BOOLEAN NOT NULL DEFAULT FALSE,
    deleted_at TIMESTAMP,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (doctor_id) REFERENCES tb_user(user_idx) ON DELETE SET NULL,
    INDEX idx_doctor_id (doctor_id),
    INDEX idx_patient_name (patient_name),
    INDEX idx_is_deleted (is_deleted)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

### 3. íŒë…ê²°ê³¼ í…Œì´ë¸” (tb_diagnosis)

#### ğŸ“Œ ê¸°ë³¸ ì •ë³´

- **ì‘ì„±ì¼ì**: 2025-01-XX
- **ì‘ì„±ì**: [ì‘ì„±ìëª…]
- **í…Œì´ë¸”ëª…**: íŒë…ê²°ê³¼ í…Œì´ë¸”
- **í…Œì´ë¸” ID**: `tb_diagnosis`
- **í…Œì´ë¸”ì„¤ëª…**: AI ì§„ë‹¨ ê²°ê³¼ ë° ì˜ì‚¬ íŒë… ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

#### ğŸ“Š ì»¬ëŸ¼ ì •ì˜

| ì»¬ëŸ¼ëª… | ì»¬ëŸ¼ ID | íƒ€ì… | ê¸¸ì´ | NN | PK | FK | UK | CK | ë¹„ê³  |
|:-------|:--------|:-----|:-----|:---|:---|:---|:---|:---|:-----|
| ì§„ë‹¨ ê³ ìœ  ID | `diagnosis_idx` | int | - | âœ… | âœ… | - | - | - | auto_increment |
| í™˜ì ID | `patient_id` | int | - | âœ… | - | âœ… | - | - | `tb_patient.patient_idx` ì°¸ì¡° |
| ì˜ì‚¬ ID | `doctor_id` | int | - | - | - | âœ… | - | - | `tb_user.user_idx` ì°¸ì¡° |
| ì´ë¯¸ì§€ URL | `image_url` | varchar | 500 | - | - | - | - | - | X-Ray ì´ë¯¸ì§€ ê²½ë¡œ |
| AI ì‹ ë¢°ë„ | `ai_confidence` | decimal | 5,4 | - | - | - | - | - | 0~1 ì‚¬ì´ |
| AI ê¶Œì¥ ì‚¬í•­ | `ai_recommendations` | text | - | - | - | - | - | - | JSON ë°°ì—´ í˜•ì‹ |
| AI ë¶„ì„ ë…¸íŠ¸ | `ai_notes` | text | - | - | - | - | - | - | - |
| Grad-CAM ì´ë¯¸ì§€ ê²½ë¡œ | `gradcam_path` | varchar | 500 | - | - | - | - | - | - |
| Grad-CAM++ ì´ë¯¸ì§€ ê²½ë¡œ | `gradcam_plus_path` | varchar | 500 | - | - | - | - | - | - |
| Layer-CAM ì´ë¯¸ì§€ ê²½ë¡œ | `layercam_path` | varchar | 500 | - | - | - | - | - | - |
| ê²€í†  ìš”ì•½ | `review_summary` | text | - | - | - | - | - | - | - |
| ê²€í†  ë…¸íŠ¸ | `review_notes` | text | - | - | - | - | - | - | - |
| ê²€í†  ìƒíƒœ | `review_status` | varchar | 20 | âœ… | - | - | - | - | 'pending' / 'approved' / 'rejected', ê¸°ë³¸ê°’: 'pending' |
| ê²€í†  ìˆ˜ì • ì¼ì‹œ | `review_updated_at` | timestamp | - | - | - | - | - | - | - |
| ìƒì„± ì¼ì‹œ | `created_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP |
| ìˆ˜ì • ì¼ì‹œ | `updated_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

#### ğŸ’» Table ìƒì„± ìŠ¤í¬ë¦½íŠ¸

```sql
CREATE TABLE tb_diagnosis (
    diagnosis_idx INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    patient_id INT NOT NULL,
    doctor_id INT,
    image_url VARCHAR(500),
    ai_confidence DECIMAL(5,4),
    ai_recommendations TEXT,
    ai_notes TEXT,
    gradcam_path VARCHAR(500),
    gradcam_plus_path VARCHAR(500),
    layercam_path VARCHAR(500),
    review_summary TEXT,
    review_notes TEXT,
    review_status VARCHAR(20) NOT NULL DEFAULT 'pending',
    review_updated_at TIMESTAMP,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (patient_id) REFERENCES tb_patient(patient_idx) ON DELETE RESTRICT,
    FOREIGN KEY (doctor_id) REFERENCES tb_user(user_idx) ON DELETE SET NULL,
    INDEX idx_patient_id (patient_id),
    INDEX idx_doctor_id (doctor_id),
    INDEX idx_review_status (review_status),
    INDEX idx_created_at (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

> **ì°¸ê³ **: AI ë°œê²¬ ì‚¬í•­(findings)ì€ ë³„ë„ í…Œì´ë¸”(`tb_diagnosis_finding`)ë¡œ ë¶„ë¦¬í•˜ê±°ë‚˜ JSON í˜•ì‹ìœ¼ë¡œ ì €ì¥ ê°€ëŠ¥í•©ë‹ˆë‹¤.

---

### 4. ì§„ë‹¨ ë°œê²¬ ì‚¬í•­ í…Œì´ë¸” (tb_diagnosis_finding)

#### ğŸ“Œ ê¸°ë³¸ ì •ë³´

- **ì‘ì„±ì¼ì**: 2025-01-XX
- **ì‘ì„±ì**: [ì‘ì„±ìëª…]
- **í…Œì´ë¸”ëª…**: ì§„ë‹¨ ë°œê²¬ ì‚¬í•­ í…Œì´ë¸”
- **í…Œì´ë¸” ID**: `tb_diagnosis_finding`
- **í…Œì´ë¸”ì„¤ëª…**: AI ì§„ë‹¨ì—ì„œ ë°œê²¬ëœ ê° ì§ˆí™˜ë³„ ì •ë³´ë¥¼ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

#### ğŸ“Š ì»¬ëŸ¼ ì •ì˜

| ì»¬ëŸ¼ëª… | ì»¬ëŸ¼ ID | íƒ€ì… | ê¸¸ì´ | NN | PK | FK | UK | CK | ë¹„ê³  |
|:-------|:--------|:-----|:-----|:---|:---|:---|:---|:---|:-----|
| ë°œê²¬ ì‚¬í•­ ê³ ìœ  ID | `finding_idx` | int | - | âœ… | âœ… | - | - | - | auto_increment |
| ì§„ë‹¨ ID | `diagnosis_id` | int | - | âœ… | - | âœ… | - | - | `tb_diagnosis.diagnosis_idx` ì°¸ì¡° |
| ì§ˆí™˜ëª… | `finding_condition` | varchar | 100 | - | - | - | - | - | - |
| í™•ë¥  | `finding_probability` | decimal | 5,4 | - | - | - | - | - | 0~1 ì‚¬ì´ |
| ì„¤ëª… | `finding_description` | text | - | - | - | - | - | - | - |
| ìƒì„± ì¼ì‹œ | `created_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP |

#### ğŸ’» Table ìƒì„± ìŠ¤í¬ë¦½íŠ¸

```sql
CREATE TABLE tb_diagnosis_finding (
    finding_idx INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    diagnosis_id INT NOT NULL,
    finding_condition VARCHAR(100),
    finding_probability DECIMAL(5,4),
    finding_description TEXT,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (diagnosis_id) REFERENCES tb_diagnosis(diagnosis_idx) ON DELETE CASCADE,
    INDEX idx_diagnosis_id (diagnosis_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

### 5. ì¼ì • í…Œì´ë¸” (tb_schedule)

#### ğŸ“Œ ê¸°ë³¸ ì •ë³´

- **ì‘ì„±ì¼ì**: 2025-01-XX
- **ì‘ì„±ì**: [ì‘ì„±ìëª…]
- **í…Œì´ë¸”ëª…**: ì¼ì • í…Œì´ë¸”
- **í…Œì´ë¸” ID**: `tb_schedule`
- **í…Œì´ë¸”ì„¤ëª…**: ì˜ì‚¬ ì¼ì •ì„ ì €ì¥í•˜ëŠ” í…Œì´ë¸”

#### ğŸ“Š ì»¬ëŸ¼ ì •ì˜

| ì»¬ëŸ¼ëª… | ì»¬ëŸ¼ ID | íƒ€ì… | ê¸¸ì´ | NN | PK | FK | UK | CK | ë¹„ê³  |
|:-------|:--------|:-----|:-----|:---|:---|:---|:---|:---|:-----|
| ì¼ì • ê³ ìœ  ID | `schedule_idx` | int | - | âœ… | âœ… | - | - | - | auto_increment |
| ì¼ì • ìœ í˜• | `schedule_type` | varchar | 20 | âœ… | - | - | - | - | 'surgery' / 'appointment' / 'xray' / 'meeting' / 'other' |
| í™˜ì ID | `patient_id` | int | - | ì¡°ê±´ë¶€ | - | âœ… | - | - | typeì´ 'surgery', 'appointment'ì¼ ë•Œ í•„ìˆ˜ |
| ì˜ì‚¬ ID | `doctor_id` | int | - | âœ… | - | âœ… | - | - | `tb_user.user_idx` ì°¸ì¡° |
| ì‹œì‘ ì¼ì‹œ | `start_datetime` | datetime | - | âœ… | - | - | - | - | - |
| ì¢…ë£Œ ì¼ì‹œ | `end_datetime` | datetime | - | âœ… | - | - | - | - | - |
| ì¥ì†Œ | `schedule_location` | varchar | 100 | âœ… | - | - | - | - | ê¸°ë³¸ê°’: '' |
| ìƒíƒœ | `schedule_status` | varchar | 20 | âœ… | - | - | - | - | 'scheduled' / 'completed' / 'cancelled' / 'in-progress', ê¸°ë³¸ê°’: 'scheduled' |
| ìƒíƒœ í…ìŠ¤íŠ¸ | `status_text` | varchar | 20 | âœ… | - | - | - | - | ê¸°ë³¸ê°’: 'ì˜ˆì •' |
| ìš°ì„ ìˆœìœ„ | `schedule_priority` | varchar | 20 | âœ… | - | - | - | - | 'low' / 'medium' / 'high' / 'urgent', ê¸°ë³¸ê°’: 'medium' |
| ì—°ê²°ëœ ì¼€ì´ìŠ¤ ID | `linked_case_id` | int | - | - | - | âœ… | - | - | `tb_diagnosis.diagnosis_idx` ì°¸ì¡° |
| ë©”ëª¨ | `schedule_notes` | text | - | âœ… | - | - | - | - | ê¸°ë³¸ê°’: '' |
| ì‚­ì œ ì—¬ë¶€ | `is_deleted` | boolean | - | âœ… | - | - | - | - | ê¸°ë³¸ê°’: FALSE |
| ì‚­ì œ ì¼ì‹œ | `deleted_at` | timestamp | - | - | - | - | - | - | - |
| ìƒì„± ì¼ì‹œ | `created_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP |
| ìˆ˜ì • ì¼ì‹œ | `updated_at` | timestamp | - | âœ… | - | - | - | - | DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP |

#### ğŸ’» Table ìƒì„± ìŠ¤í¬ë¦½íŠ¸

```sql
CREATE TABLE tb_schedule (
    schedule_idx INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
    schedule_type VARCHAR(20) NOT NULL,
    patient_id INT,
    doctor_id INT NOT NULL,
    start_datetime DATETIME NOT NULL,
    end_datetime DATETIME NOT NULL,
    schedule_location VARCHAR(100) NOT NULL DEFAULT '',
    schedule_status VARCHAR(20) NOT NULL DEFAULT 'scheduled',
    status_text VARCHAR(20) NOT NULL DEFAULT 'ì˜ˆì •',
    schedule_priority VARCHAR(20) NOT NULL DEFAULT 'medium',
    linked_case_id INT,
    schedule_notes TEXT NOT NULL DEFAULT '',
    is_deleted BOOLEAN NOT NULL DEFAULT FALSE,
    deleted_at TIMESTAMP,
    created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (patient_id) REFERENCES tb_patient(patient_idx) ON DELETE SET NULL,
    FOREIGN KEY (doctor_id) REFERENCES tb_user(user_idx) ON DELETE RESTRICT,
    FOREIGN KEY (linked_case_id) REFERENCES tb_diagnosis(diagnosis_idx) ON DELETE SET NULL,
    INDEX idx_doctor_datetime (doctor_id, start_datetime),
    INDEX idx_patient_id (patient_id),
    INDEX idx_datetime_range (start_datetime, end_datetime)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

---

## III. ê´€ê³„ ìš”ì•½

### ğŸ”— ì™¸ë˜í‚¤ ê´€ê³„

| ìˆœë²ˆ | ê´€ê³„ | ì°¸ì¡° | ì¹´ë””ë„ë¦¬í‹° | ON DELETE |
|:-----|:-----|:-----|:-----------|:----------|
| 1 | `tb_patient` â†’ `tb_user` | `patient.doctor_id` â†’ `user.user_idx` | N:1 | SET NULL |
| 2 | `tb_diagnosis` â†’ `tb_patient` | `diagnosis.patient_id` â†’ `patient.patient_idx` | N:1 | RESTRICT |
| 3 | `tb_diagnosis` â†’ `tb_user` | `diagnosis.doctor_id` â†’ `user.user_idx` | N:1 | SET NULL |
| 4 | `tb_diagnosis_finding` â†’ `tb_diagnosis` | `finding.diagnosis_id` â†’ `diagnosis.diagnosis_idx` | N:1 | CASCADE |
| 5 | `tb_schedule` â†’ `tb_user` | `schedule.doctor_id` â†’ `user.user_idx` | N:1 | RESTRICT |
| 6 | `tb_schedule` â†’ `tb_patient` | `schedule.patient_id` â†’ `patient.patient_idx` | N:1 (ì¡°ê±´ë¶€) | SET NULL |
| 7 | `tb_schedule` â†’ `tb_diagnosis` | `schedule.linked_case_id` â†’ `diagnosis.diagnosis_idx` | N:1 (ì„ íƒì ) | SET NULL |

---

## IV. ì¸ë±ìŠ¤ ìš”ì•½

### ğŸ“‘ ì£¼ìš” ì¸ë±ìŠ¤

#### `tb_user`
- `user_email`: **UNIQUE** ì¸ë±ìŠ¤ (ë¡œê·¸ì¸ ID ì¤‘ë³µ ë°©ì§€)
- `user_role`: ì¼ë°˜ ì¸ë±ìŠ¤ (ì—­í• ë³„ ì¡°íšŒ)

#### `tb_patient`
- `doctor_id`: ì¼ë°˜ ì¸ë±ìŠ¤ (ì˜ì‚¬ë³„ í™˜ì ì¡°íšŒ)
- `patient_name`: ì¼ë°˜ ì¸ë±ìŠ¤ (í™˜ì ê²€ìƒ‰)
- `is_deleted`: ì¼ë°˜ ì¸ë±ìŠ¤ (ì‚­ì œë˜ì§€ ì•Šì€ í™˜ì ì¡°íšŒ)

#### `tb_diagnosis`
- `patient_id`: ì¼ë°˜ ì¸ë±ìŠ¤ (í™˜ìë³„ ì§„ë‹¨ ê¸°ë¡ ì¡°íšŒ)
- `doctor_id`: ì¼ë°˜ ì¸ë±ìŠ¤ (ì˜ì‚¬ë³„ ì§„ë‹¨ ê¸°ë¡ ì¡°íšŒ)
- `review_status`: ì¼ë°˜ ì¸ë±ìŠ¤ (ê²€í†  ìƒíƒœë³„ ì¡°íšŒ)
- `created_at`: ì¼ë°˜ ì¸ë±ìŠ¤ (ë‚ ì§œìˆœ ì •ë ¬)

#### `tb_diagnosis_finding`
- `diagnosis_id`: ì¼ë°˜ ì¸ë±ìŠ¤ (ì§„ë‹¨ë³„ ë°œê²¬ ì‚¬í•­ ì¡°íšŒ)

#### `tb_schedule`
- `(doctor_id, start_datetime)`: **ë³µí•© ì¸ë±ìŠ¤** (ì˜ì‚¬ë³„ ì¼ì • ì¡°íšŒ ë° ì •ë ¬)
- `patient_id`: ì¼ë°˜ ì¸ë±ìŠ¤ (í™˜ìë³„ ì¼ì • ì¡°íšŒ)
- `(start_datetime, end_datetime)`: **ë³µí•© ì¸ë±ìŠ¤** (ê¸°ê°„ë³„ ì¼ì • ì¡°íšŒ)

---

## V. ë°ì´í„° íƒ€ì… ì„¤ëª…

| íƒ€ì… | ì„¤ëª… | ì˜ˆì‹œ |
|:-----|:-----|:-----|
| `int` | ì •ìˆ˜í˜• (32ë¹„íŠ¸) | `123`, `-45` |
| `varchar(n)` | ê°€ë³€ ê¸¸ì´ ë¬¸ìì—´ (ìµœëŒ€ nì) | `varchar(50)` â†’ ìµœëŒ€ 50ì |
| `text` | ê¸´ í…ìŠ¤íŠ¸ (ìµœëŒ€ 65,535ì) | ê¸´ ì„¤ëª…, ë©”ëª¨ ë“± |
| `decimal(5,4)` | ì†Œìˆ˜ì  4ìë¦¬ê¹Œì§€ í‘œí˜„ ê°€ëŠ¥í•œ ìˆ«ì (ì „ì²´ 5ìë¦¬) | `0.8725`, `1.0000` |
| `boolean` | TRUE ë˜ëŠ” FALSE | `TRUE`, `FALSE` |
| `datetime` | ë‚ ì§œ ë° ì‹œê°„ (YYYY-MM-DD HH:MM:SS) | `2025-01-15 14:30:00` |
| `timestamp` | ìë™ íƒ€ì„ìŠ¤íƒ¬í”„ (ìë™ ì—…ë°ì´íŠ¸ ê°€ëŠ¥) | `2025-01-15 14:30:00` |

---

## VI. ì œì•½ì¡°ê±´

| ì œì•½ì¡°ê±´ | ì•½ì–´ | ì„¤ëª… |
|:---------|:-----|:-----|
| **Primary Key** | PK | ê° í…Œì´ë¸”ì˜ ê³ ìœ  ì‹ë³„ì (auto_increment) |
| **Foreign Key** | FK | ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ì˜ ì°¸ì¡° ê´€ê³„ |
| **NOT NULL** | NN | í•„ìˆ˜ ì…ë ¥ í•„ë“œ |
| **UNIQUE** | UK | ì¤‘ë³µ ë¶ˆê°€ í•„ë“œ |
| **DEFAULT** | - | ê¸°ë³¸ê°’ ì„¤ì • |
| **ON DELETE RESTRICT** | - | ì°¸ì¡° ë¬´ê²°ì„± ìœ ì§€ (ì°¸ì¡°ëœ ë ˆì½”ë“œ ì‚­ì œ ë°©ì§€) |
| **ON DELETE SET NULL** | - | ì°¸ì¡°ëœ ë ˆì½”ë“œ ì‚­ì œ ì‹œ NULLë¡œ ì„¤ì • |
| **ON DELETE CASCADE** | - | ì°¸ì¡°ëœ ë ˆì½”ë“œ ì‚­ì œ ì‹œ ê´€ë ¨ ë ˆì½”ë“œë„ í•¨ê»˜ ì‚­ì œ |

---

## VII. ì°¸ê³ ì‚¬í•­

### âš ï¸ ì‹¤ì œ êµ¬í˜„ê³¼ì˜ ì°¨ì´ì 

ë³¸ ëª…ì„¸ì„œëŠ” **SQL í˜•ì‹**ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆìœ¼ë‚˜, ì‹¤ì œ í”„ë¡œì íŠ¸ëŠ” **MongoDB**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

#### ì£¼ìš” ì°¨ì´ì 

| í•­ëª© | SQL (ë³¸ ëª…ì„¸ì„œ) | MongoDB (ì‹¤ì œ êµ¬í˜„) |
|:-----|:----------------|:-------------------|
| ë°ì´í„°ë² ì´ìŠ¤ ì¢…ë¥˜ | MySQL | MongoDB |
| Primary Key | `auto_increment INT` | `ObjectId` |
| Foreign Key | FK ì œì•½ì¡°ê±´ | ì°¸ì¡°(Reference) |
| ì¤‘ì²© ë°ì´í„° | ë³„ë„ í…Œì´ë¸” | ì¤‘ì²© ê°ì²´ |
| ì¸ë±ìŠ¤ | ëª…ì‹œì  ì¸ë±ìŠ¤ | ìë™ ì¸ë±ìŠ¤ |

#### ì‹¤ì œ êµ¬í˜„ ì •ë³´

- **MongoDB ì»¬ë ‰ì…˜**: `users`, `patients`, `diagnoses`, `schedules`
- **ODM**: Mongoose ì‚¬ìš©
- **ì¤‘ì²© ìŠ¤í‚¤ë§ˆ**: `aiAnalysis`, `review` ë“±ì„ ì¤‘ì²© ê°ì²´ë¡œ ì €ì¥

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2025-01-XX  
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-01-XX
